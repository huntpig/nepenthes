

// smb message header identifier
char smb_header_fix[] = {0xff,0x53,0x4d,0x42};

char vuln_rpccall_uuid[] = "\xc8\x4f\x32\x4b\x70\x16\xd3\x01\x12\x78\x5a\x47\xbf\x6e\xe1\x88";

// dcerpc bind ack "header" (fixed except length)
char dcerpc_bind_data[] = 
"\x05\x00\x0c\x03\x10\x00\x00\x00\x94\x01\x00\x00\x00\x00\x00\x00"
"\xb8\x10\xb8\x10\xf7\x4e\x00\x00\x0e\x00\x5c\x50\x49\x50\x45\x5c"
"\x62\x72\x6f\x77\x73\x65\x72\x00\x0f\x00\x00\x00"; //len: 44;

// dcerpc context item rejected in bind ack
char dcerpc_provider_rejection[] = 
"\x02\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00"; //len: 24

// dcerpc context item acceptance
char dcerpc_acceptance[] = 
"\x00\x00\x00\x00\x04\x5d\x88\x8a\xeb\x1c\xc9\x11\x9f\xe8\x08\x00"
"\x2b\x10\x48\x60\x02\x00\x00\x00"; //len: 24

// response in stage 1
char negotiate_protocol_response[] = 
"\x00\x00\x00\x55\xff\x53\x4d\x42\x72\x00\x00\x00\x00\x98\x01\x28"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xaa"
"\x00\x00\xc6\xa3\x11\x03\x00\x03\x0a\x00\x01\x00\x04\x11\x00\x00"
"\x00\x00\x01\x00\x00\x00\x00\x00\xfd\xe3\x00\x00\x67\xd9\x26\x46"
"\xad\x3d\xc9\x01\xc4\xff\x00\x10\x00\xcf\x93\x98\x87\x52\x1d\x7c"
"\x42\x9a\xed\x0f\x24\x73\xdb\x5c\x46";

// response in stage 2
char session_setup_response[] = 
"\x00\x00\x00\x61\xff\x53\x4d\x42\x73\x00\x00\x00\x00\x98\x01\x20"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xaa"
"\x00\x08\xc6\xa3\x04\xff\x00\x00\x00\x01\x00\x09\x00\x2d\x00\xa1"
"\x07\x30\x05\xa0\x03\x0a\x01\x00"
"\x57\x69\x6e\x64\x6f\x77\x73\x20\x32\x30\x30\x30\x20\x32\x31\x39"
"\x35\x00\x57\x69\x6e\x64\x6f\x77\x73\x20\x32\x30\x30\x30\x20\x35"
"\x2e\x30\x00\x57\x4f\x52\x4b\x47\x52\x4f\x55\x50\x00";

char session_setup_response_andx_tree_connect[] = 
"\x00\x00\x00\xb0\xff\x53\x4d\x42\x73\x00\x00\x00\x00\x98\x07\xc8"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xfe"
"\x00\x08\x10\x00\x03\x75\x00\x99\x00\x01\x00\x70\x00\xff\x57\x00"
"\x69\x00\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x58\x00"
"\x50\x00\x20\x00\x33\x00\x37\x00\x39\x00\x30\x00\x20\x00\x53\x00"
"\x65\x00\x72\x00\x76\x00\x69\x00\x63\x00\x65\x00\x20\x00\x50\x00"
"\x61\x00\x63\x00\x6b\x00\x20\x00\x32\x00\x00\x00\x57\x00\x69\x00"
"\x6e\x00\x64\x00\x6f\x00\x77\x00\x73\x00\x20\x00\x58\x00\x50\x00"
"\x20\x00\x35\x00\x2e\x00\x32\x00\x00\x00\x57\x00\x4f\x00\x52\x00"
"\x4b\x00\x47\x00\x52\x00\x4f\x00\x55\x00\x50\x00\x00\x07\xff\x00"
"\xb0\x00\x01\x00\xff\x01\x00\x00\xff\x01\x00\x00\x06\x00\x49\x50"
"\x43\x00\x00\x00";

// response in stage 4
char treeconnect_response[] = 
"\x00\x00\x00\x2e\xff\x53\x4d\x42\x75\x00\x00\x00\x00\x98\x01\x20"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xaa"
"\x00\x08\xc6\xa3\x03\xff\x00\x2e\x00\x01\x00\x05\x00\x49\x50\x43"
"\x00\x00";

// response in stage 5
char ntcreate_response[] = 
"\x00\x00\x00\x87\xff\x53\x4d\x42\xa2\x00\x00\x00\x00\x98\x01\x20"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xaa"
"\x00\x08\xc6\xa3\x2a\xff\x00\x87\x00\x00\x00\x40\x01\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x80\x00\x00\x00\x00\x10\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x02\x00\xff\x05\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00"
"\x00\x9b\x01\x12\x00\x9b\x01\x12\x00\x00\x00";

// response in stage 6 and 8
char write_response[] = 
"\x00\x00\x00\x2f\xff\x53\x4d\x42\x2f\x00\x00\x00\x00\x98\x01\x20"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xff\xaa"
"\x00\x08\xc6\xa3\x06\xff\x00\x2f\x00\x3c\x01\xff\xff\x00\x00\x00"
"\x00\x00\x00";

// response in stage 6 for smb transaction mode
char transaction_bind_ack[] = 
"\x00\x00\x00\x7c\xff\x53\x4d\x42\x25\x00\x00\x00\x00\x98\x07\xc8"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x10\x4c\x12"
"\x01\x60\x40\x01\x0a\x00\x00\x44\x00\x00\x00\x00\x00\x38\x00\x00"
"\x00\x44\x00\x38\x00\x00\x00\x00\x00\x45\x00\x00\x05\x00\x0c\x03"
"\x10\x00\x00\x00\x44\x00\x00\x00\x01\x00\x00\x00\xb8\x10\xb8\x10"
"\x17\xa1\x01\x00\x0e\x00\x5c\x50\x49\x50\x45\x5c\x62\x72\x6f\x77"
"\x73\x65\x72\x00\x01\x00\x00\x00\x00\x00\x00\x00\x04\x5d\x88\x8a"
"\xeb\x1c\xc9\x11\x9f\xe8\x08\x00\x2b\x10\x48\x60\x02\x00\x00\x00";

// response in stage 7
char read_response[] = 
"\x00\x00\x00\xad\xff\x53\x4d\x42\x2e\x05\x00\x00\x80\x98\x01\x60"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\xc4\x09"
"\x00\x08\x42\x4c\x0c\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x71"
"\x00\x3c\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x72\x00\x00";

// response in stage 8 for smb transaction mode
// it actually is an error as we already have our shellcode...
char transaction_call_error_response[] = 
"\x00\x00\x00\x60\xff\x53\x4d\x42\x25\x00\x00\x00\x00\x98\x07\xc8"
"\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x10\x4c\x12"
"\x01\x60\xc0\x01\x0a\x00\x00\x28\x00\x00\x00\x00\x00\x38\x00\x00"
"\x00\x28\x00\x38\x00\x00\x00\x00\x00\x29\x00\x00\x05\x00\x02\x03"
"\x10\x00\x00\x00\x28\x00\x00\x00\x01\x00\x00\x00\x10\x00\x00\x00"
"\x00\x00\x00\x00\x01\x00\x00\x00\x00\x50\x45\x5c\x01\x00\x00\x00"
"\x7b\x00\x00\x00";


